<main>
    <div class="box" #box>
        <!-- Login Form -->
        <div class="form-box login">
            <form [formGroup]="loginForm" (ngSubmit)="onLogin()">
                <h1>Sign In</h1>

                <!-- Username input -->
                <div class="input-box">
                    <div class="input-field">
                        <input type="text"
                               placeholder="Username"
                               formControlName="username"
                               required>
                        <i class="fas fa-user"></i>
                    </div>
                    <div *ngIf="loginForm.get('username')?.invalid && loginForm.get('username')?.touched">
                        <p class="error-message">Username is required</p>
                    </div>
                </div>

                <!-- Password input -->
                <div class="input-box">
                    <div class="input-field">
                        <input type="password"
                               placeholder="Password"
                               formControlName="password"
                               required>
                        <i class="fas fa-lock"></i>
                    </div>
                    <div *ngIf="loginForm.get('password')?.invalid && loginForm.get('password')?.touched">
                        <p class="error-message">Password is required</p>
                    </div>
                </div>

                <div *ngIf="loginError">
                    <p class="error-message">{{ loginError }}</p>
                </div>

                <button type="submit" class="btn" [disabled]="loginForm.invalid">Sign In</button>
            </form>
        </div>

        <!-- Register Form -->
        <div class="form-box register">
            <form [formGroup]="registerForm" (ngSubmit)="onRegister()">
                <h1>Create Account</h1>

                <!-- General errors section -->
                <div *ngIf="hasRegisterError('general')" class="alert alert-danger">
                    {{ getRegisterError('general') }}
                </div>

                <!-- Username input -->
                <div class="input-box">
                    <div class="input-field">
                        <input type="text"
                               placeholder="Username"
                               formControlName="username"
                               required>
                        <i class="fas fa-user"></i>
                    </div>
                    <div *ngIf="registerForm.get('username')?.invalid && registerForm.get('username')?.touched">
                        <p class="error-message">Username is required</p>
                    </div>
                    <div *ngIf="hasRegisterError('username')">
                        <p class="error-message">{{ getRegisterError('username') }}</p>
                    </div>
                </div>

                <!-- Email input -->
                <div class="input-box">
                    <div class="input-field">
                        <input type="email"
                               placeholder="Email"
                               formControlName="email"
                               required>
                        <i class="fas fa-envelope"></i>
                    </div>
                    <div *ngIf="registerForm.get('email')?.invalid && registerForm.get('email')?.touched">
                        <p class="error-message">Please enter a valid email</p>
                    </div>
                    <div *ngIf="hasRegisterError('email')">
                        <p class="error-message">{{ getRegisterError('email') }}</p>
                    </div>
                </div>

                <!-- Password input -->
                <div class="input-box">
                    <div class="input-field">
                        <input type="password"
                               placeholder="Password"
                               formControlName="password"
                               required>
                        <i class="fas fa-lock"></i>
                    </div>
                    <div *ngIf="registerForm.get('password')?.invalid && registerForm.get('password')?.touched">
                        <p class="error-message">Password must be at least 8 characters</p>
                    </div>
                    <div *ngIf="hasRegisterError('password')">
                        <p class="error-message">{{ getRegisterError('password') }}</p>
                    </div>
                </div>

                <!-- Confirm password input -->
                <div class="input-box">
                    <div class="input-field">
                        <input type="password"
                               placeholder="Confirm Password"
                               formControlName="password_confirm"
                               required>
                        <i class="fas fa-lock"></i>
                    </div>
                    <div *ngIf="registerForm.get('password_confirm')?.errors?.['required'] && registerForm.get('password_confirm')?.touched">
                        <p class="error-message">Password confirmation is required</p>
                    </div>
                    <div *ngIf="registerForm.get('password_confirm')?.errors?.['passwordMismatch']">
                        <p class="error-message">Passwords do not match</p>
                    </div>
                    <div *ngIf="hasRegisterError('password_confirm')" class="error-message">
                        <p class="error-message">{{ getRegisterError('password_confirm') }}</p>
                    </div>
                </div>

                <button type="submit" class="btn" [disabled]="registerForm.invalid">Create Account</button>
            </form>
        </div>

        <!-- Toggle Box with Modern Theme -->
        <div class="toggle-box">
            <div class="toggle-panel toggle-left">
                <h1>Hello, Welcome!</h1>
                <p>Don't have an account?</p>
                <button class="btn register-btn" #registerBtn>Create Account</button>
            </div>

            <div class="toggle-panel toggle-right">
                <h1>Welcome Back!</h1>
                <p>Already have an account?</p>
                <button class="btn login-btn" #loginBtn>Sign In</button>
            </div>
        </div>
    </div>
</main>
